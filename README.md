# RacePredictor v2.1

**データドリブンなランニングタイム予測アプリ**

高精度な予測を実現するため、まずは豊富なデータ収集に特化したベータ版を提供中

## 🚀 現在の開発状況

### ✅ 実装完了
- **ユーザー管理**: 認証・プロフィール管理
- **ダッシュボード**: 統計表示・チャート・最近の活動
- **基本UI**: React/Next.js によるモダンインターフェース
- **レスポンシブデザイン**: モバイル・タブレット対応
- **CSVインポート**: Garmin対応（28カラム完全対応）
- **認証システム**: JWT認証・自動ログイン

### 🔄 実装中
- **練習記録システム**: 詳細構造化データ対応
- **レース結果管理**: 9種目対応
- **データ可視化強化**: 詳細グラフ・分析機能

### 📅 Coming Soon（Phase 3）
- **高精度タイム予測**: 蓄積データを活用した機械学習モデル
- **コーチング機能**: ウォームアップ最適化・個人適応
- **トレーニング提案**: AI による最適な練習メニュー

## 🎯 なぜ予測機能を後回しにするのか

### データ収集優先戦略
1. **精度重視**: 十分なデータなしの予測は不正確
2. **差別化**: リリース時に競合より高い精度を実現
3. **個人化**: 多様なランナーデータで個人適応を可能に

### 現在のフォーカス
```
高品質なUI + 豊富なデータ収集 = 将来の高精度予測
```

## 📊 主な機能

### 練習記録システム（詳細仕様）

#### 練習セッション構造
```
1日の練習
├─ 部練習数: 1部練/2部練/3部練 (手動選択)
├─ セッション1
│  ├─ 時間帯: 朝練/午前練/午後練/その他 (手動選択)
│  ├─ ウォームアップ (任意)
│  ├─ メイン練習 (必須)
│  └─ クールダウン (任意)
├─ セッション2 (2部練以上の場合)
└─ セッション3 (3部練の場合)
```

#### 練習種別分類

**持久系練習**
- イージーラン（回復走）
- ジョギング  
- ロング走（LSD）
- ミディアムラン

**強度系練習**
- テンポ走（閾値走）
- インターバル走（距離自由設定：100m、200m、400m、800m、1000m、1600m等）
- レペティション（距離自由設定：50m、100m、150m、200m、300m等）
- ビルドアップ走
- ファルトレク

**距離設定仕様**
- 自由入力：50m〜100km（数値フィールド + 単位選択）
- プリセット選択：よく使用される距離の選択肢提供
- データ保存：メートル単位で統一保存
- 表示変換：1000m → 1km の自動表示変換

**補強・その他**
- 坂道練習（上り坂、下り坂）
- クロストレーニング
- 筋力トレーニング
- 休養日

#### インターバル練習の詳細記録

**メインセット**
- 距離・タイム・ペース
- 心拍数（開始・最高・終了時）
- 主観的強度（RPE 1-10）
- ラップスプリット（長距離の場合）

**レスト期間分析**
- レスト形式: 完全休息/ジョグ/ウォーク
- レスト距離（動的回復の場合）
- レスト時間
- レストペース
- 心拍数回復率（最高→レスト終了時）
- 主観的回復感

### レース結果管理
- **9種目対応**: 800m, 1500m, 3000m, 5000m, 10000m, 5km, 10km, ハーフマラソン, フルマラソン
- **記録追跡**: ベストタイム・進歩の可視化
- **スプリット記録**: 詳細なレース分析
- **将来の分析準備**: Phase 3での予測精度向上に活用

### CSVインポート機能
- **Garmin Connect対応**: 28カラム完全対応
- **エンコーディング自動判定**: UTF-8, Shift-JIS, CP932対応
- **プレビュー機能**: インポート前のデータ確認
- **自動練習種別推定**: インターバル、テンポ走、ロング走等の自動分類

## 🛠 技術スタック

### バックエンド
- **FastAPI 0.104+** - 高性能API
- **SQLAlchemy 2.0+** - ORM
- **PostgreSQL 14+** - データベース
- **JWT認証** - セキュアな認証

### フロントエンド
- **React/Next.js 14+** - モダンUI・SSR対応
- **TypeScript** - 型安全な開発
- **Tailwind CSS** - レスポンシブデザイン
- **Plotly** - データ可視化

### インフラ
- **Docker** - コンテナ化
- **GitHub Actions** - CI/CD

## 🚀 クイックスタート

### 前提条件
- Docker & Docker Compose
- Git
- Node.js 18+ (React UI使用時)
- Python 3.11+ (ローカル開発時)

### ローカル開発環境（推奨）
```bash
# 1. リポジトリクローン
git clone https://github.com/your-repo/RacePredictor.git
cd RacePredictor

# 2. バックエンド起動
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

# 3. フロントエンド起動（別ターミナル）
cd frontend-react
npm install
npm run dev

# 4. アクセス
# React UI: http://localhost:3000
# API: http://localhost:8000
```

## 📚 使用方法

### 基本的な使用フロー

#### 1. アカウント作成・ログイン
```
http://localhost:3000 → 「新規登録」または「ログイン」
```

#### 2. 練習データ記録
- **練習記録ページ**: `/workouts` で練習一覧・新規作成
- **部練習選択**: 1部練/2部練/3部練から選択
- **構成要素入力**: ウォームアップ/メイン/クールダウンを個別記録
- **インターバル詳細**: セット・レスト時間・心拍数回復を記録
- **CSVインポート**: `/import` でGarminデータ一括取り込み

#### 3. レース結果管理
- **レース結果ページ**: `/races` でレース一覧・新規作成
- **9種目対応**: 800m〜フルマラソン
- **詳細記録**: スプリット・戦略・反省点

#### 4. データ分析
- **ダッシュボード**: `/dashboard` で統計・グラフ表示
- **練習履歴**: 週間・月間の走行距離推移
- **強度分析**: 練習種別・強度の分布

## 📈 ロードマップ

### Phase 2: データ収集特化（現在〜2025年12月）
- ✅ 基本機能完成
- 🔄 詳細練習記録システム
- 🔄 データ収集・可視化強化
- 🎯 目標: 100-500ユーザー、10,000練習記録

### Phase 3: 高精度予測・コーチング（2026年1月〜3月）
- 🔮 機械学習モデル実装
- 🏃 ウォームアップ最適化分析
- 📊 レース当日ウォームアップ推奨
- 🎯 個人適応機能
- 📈 目標: 予測誤差3%以内

### Phase 4: 本格サービス化（2026年4月〜）
- 💰 有料プラン開始
- 📱 モバイルアプリ
- 🌍 マーケティング展開

## 🔮 将来のコーチング機能（Phase 3予定）

### ウォームアップ最適化
- **分析指標**: ウォームアップ距離 vs メイン練習パフォーマンス相関
- **個人化**: 最適なウォームアップパターンの提案
- **レース適用**: レース当日ウォームアップ推奨（距離・ペース）

### レスト分析
- **回復効率**: 心拍数回復率の追跡
- **最適化**: 個人別最適レスト時間の算出
- **比較分析**: 動的 vs 静的回復の効果比較

### 予測機能
- **VDOT計算**: 個人特性に基づく更新
- **レースタイム予測**: 100練習以上で個人モデル構築
- **練習提案**: AI による最適な練習メニュー

## 🤝 ベータテスター募集

現在、データ収集とUI改善のためのベータテスターを募集中！

### 参加メリット
- 🆓 将来の有料機能を無料で先行利用
- 📊 自分の練習データの詳細分析
- 🏃 高精度予測機能の優先アクセス

### 参加方法
1. アプリにユーザー登録
2. 2週間以上の練習データを入力
3. フィードバックをGitHub Issuesに投稿

## ⚡ パフォーマンス仕様

- **CSV処理**: 1000行を5秒以内
- **ページロード**: 3秒以内  
- **同時接続**: 1000ユーザー対応
- **ファイルサイズ**: 10MB制限
- **対応ブラウザ**: Chrome, Firefox, Safari, Edge

## 🔐 セキュリティ

- **認証**: JWT トークン（30分有効）
- **パスワード**: bcrypt ハッシュ化
- **通信**: HTTPS必須（本番環境）
- **データ**: 個人情報暗号化保存

## 🔧 開発者向け情報

### データベース設計

#### 練習記録テーブル（拡張予定）
```sql
TrainingDay
├─ id (UUID)
├─ user_id (UUID)
├─ date (DATE)
├─ session_count (INTEGER) -- 1,2,3部練
├─ session_data (JSONB) -- 構造化セッションデータ
├─ weather (VARCHAR)
├─ temperature (FLOAT)
└─ notes (TEXT)

SessionData構造:
{
  "sessions": [
    {
      "session_number": 1,
      "session_type": "朝練",
      "start_time": "06:00",
      "parts": [
        {
          "type": "ウォームアップ",
          "distance_m": 2000,
          "time_seconds": 720,
          "pace_per_km": "6:00",
          "heart_rate_avg": 140,
          "notes": "軽めのジョグ"
        },
        {
          "type": "メイン練習",
          "workout_type": "インターバル",
          "sets": [...],
          "rests": [...]
        }
      ]
    }
  ]
}
```

### テスト環境整備

```bash
# バックエンド起動
cd backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

# フロントエンド起動
cd frontend-react
npm install
npm run dev
```

### アクセス確認
- **React UI**: http://localhost:3000
- **API**: http://localhost:8000
- **API Docs**: http://localhost:8000/docs

## 🤝 コントリビューション

### 歓迎する貢献
- 🐛 バグ報告
- 💡 機能提案
- 📝 ドキュメント改善
- 🧪 テストデータ提供

### 貢献方法
1. Issue作成
2. Fork & ブランチ作成
3. 変更実装
4. Pull Request作成

## 📄 ライセンス

MIT License - 詳細は[LICENSE](LICENSE)ファイルを参照

---

**RacePredictor v2.1** - まずはデータ、そして精度。データドリブンなトレーニングで目標達成へ 🏃‍♂️

**最終更新**: 2025年9月20日